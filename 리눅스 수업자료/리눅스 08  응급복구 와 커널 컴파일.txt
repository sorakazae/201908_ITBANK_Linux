응급 복구
리눅스를 사용하다가 root의 비밀번호를 잊어 버려서 로그인을 하지 못할 경우 해결하는 방법을 실습해 보자

잊어버린 root 사용자의 비밀번호를 새 비밀번호로 변경하자
0. Vm-Snapshot-설치직후(셧다운)을 선택
부팅을 하고 로그인 시에 root 사용자의 비밀번호를 잊어 버렸다면 더 이상키보드 로그인을 할 수 없다 " 재시작" 아이콘을 클릭해서 리부팅한다.
1. 부팅이 아래 화면이 나오면, 화면을 마우스로 한 번 클릭 후에 아무키나 눌러야 한다, 여유가 5초밖에 동작이 늦으면 그냥 넘어갈 것이다.
2. GRUB의 메뉴 화면이 나타난다.
- 지금은 부팅 메뉴가 한개 밖에 없으므로, " Fedara Core" 커서에 있을 것이다. 이 상태에서 'e' 키를 누른다('Edit' 이라는 의미다)
- 키보드의 화살표를 눌러서 두 번쨰의 "kernel/boot/vm.." 커서를 놓고, 'e' 키를 누른다.
- grub edit > 프롬프트에 아래와 같이 나오면 제일 뒤에 "1"(공백을 1앞에 넣는다)을 써주고 Enter를 누른다.
- 제일 뒤에 1이 추가 되었다. 'b'를 눌러 부팅한다.

3. 부팅은 런레벨 1(싱글모드)로 부팅이 될 것 이다.
- 싱글모드로 부팅 시에는 로그인 창이 별도로 뜨지 않고, 그냥 root 사용자로 로그인이 자동으로 된다. whoami 명령으로 현재 로그인된 사용자를 확인한다.
- root 사용자이므로 자신의 비밀번호를 비롯한 다른 모든 사용자의 모든 비밀번호가 무엇인지는 모르더라도, 변경할 수 있는 권한은 있다. "passwd" 명령으로 자신(root)의 비밀번호를 변경하자
- 비밀번호가 변경된 후에 reboot 명령을 입력해서 시스탬을 재부팅한다. 이제는 새로운 root 사용자의 비밀번호로 정상적으로 로그인 할 수 있을 것이다.

시스템을 보호하려면 GRUB 자체를 편집할 수 없게 설정해야한다

♣ 부트로더
리눅스에서는 전통적으로 LILO를 부트 로더로 사용했지만, 페도라에서는 기본적으로 GRUB 부트 로더를 제공한다. GRUB 부트 로더는 LILO에 비해서 향상된 기능을 제공한다. 우선 GRUB 부트 로더의 몇 가지 특징을 들면 다음과 같다.
- 부트 정보를 사용자가 임의로 변경하여 부팅할 수 있다. 즉 부팅 정보가 올바르지 않더라도 수정하여 부팅이 가능하다.
- 다른 여러 가지 운영체제와 멀티 부팅이 가능하다.
- 대화식 설정을 제공해서 커널의 경로 및 파일명만 알고 있으면 부팅이 가능하다.

GRUB의 설정 파일은 /boot/grub/grub.conf며, /etc/grub.conf는 링크 파일이다. 페도라 서버의 grub.conf 파일은 다음과 같이 구성 되어 있다

defualt=0
timeout=5
splafhimage=(hd0,0) /boot/grub/splash.xpm.gz
hiddenmenu
title Fedora Core (2.6.11-1.1369_FC4)
root (hd0,0)
kernel /boot/vmlinuz-2.6.11-1.1369_FC4 ro root=LABEL=/ rhgb quiet 
initrd /boot/initrd-2.6.1-1.1369_FC4.img

(1) default=0
기본적으로 부팅되는 부트 엔트리의 번호다, 각각의 부트 엔트리는 "title"로 시작하므로 이 grub.conf 파일의 부트 엔트리는 1개 뿐이다. 순번은 0,1,2,3.. 으로 매겨지므로 0번이 들어 있는 것이다.

(2) timeout=5
초기에 부팅할 때 5초 동안 여유를 준다는 의미다. 5초 동안 아무런 작업을 하지 않으면 "default-번호"로 설정된 엔트리로 부팅한다.

(3) splashimage=(hd0,0) /boot/grub/splash.xpm.gz
GRUB 메뉴의 부팅 이미지 파일을 지정한 부분이다. "(hd0,0) 에서 "hd0" 은 0번째(첫 번째) IDE 하드디스크를 의미한다. 즉 /dev/hda 장치를 의미하고 다음의 "0" 0번쨰(첫번째) 파티션을 의미한다. 그러므로 결국 /dev/hda1 장치를 의미하는 것이다.
(4)hiddenmenu
기본적으로 GRUB 부트 로더를 보여주는 않는 설정이다. 삭제하면 GRUB 부트 로더 화면이 처음에 보일 것이다.

(5) title Fedora Core (2.6.11-1.1369_FC4)
"titie"은 부팅되는 부트 엔트리를 의미하며 그 되느 초기 화면에서 보이는 메뉴 이름이다.
1. root(hd0,0)
/boot 파티션이 저장된 장치를 의미한다.
2. 
kernel /boot/vmlinuz-2.6.11-1.1369_FC4 ro root=LABEL=/ rhgb quiet 
"kernel" 다음에 나오는  것은 실제 부팅할  커널이다. "root=LABEL/" 디바이스 이름 대신에 레이블 이름으로 사용한 것이다. 즉 "root=/dev/hda1" 으로 써도 된다. 'rhgb"는 "Redhat Graphic Booting"의 약어다 "quiet"는 부팅시  메세지를 화면에 출력하지 않도록 설정하는 것이다.
3. initrd /boot/initrd-2.6.1-1.1369_FC4.img
initrs 이미지가 있는 경로와 파일명을 명시해 준다.

실습 : GRUB 부트 로더를 변경하고 부트로더에 암호를 설정하자
1. 부팅 시간을 10초간 대기하고 GRUO 화면이 초기에 보이도록 설정하자
1-1 gedit이나 vi /boot/grub/grub.conf 나 /etc/grub.conf 파일을 열고 부팅시간을 10초로 변경하자. 또 hiddenmenu는 지우거나, 앞에 #을 붙여서 주석으로 처리한 후 저장하고 닫는다.
timeout=10
# hiddenmenu
1. 터미널에서 gedit /etc/grub.conf &"명령으로 grub.conf 파일을 백그라운드로 열어 놓는다.
2. 터미널에서 grub 명령을 입력하면 grub> 프롬프트가 나타난다.
- md5crypt은 입력 한 후 사용할 암호를 입력하면 아래와 같이 암호화된 결과가 나온다
grub>md5crypt
password:1234
- 이 암호화된 결과를 마우스로 드래그 한후, 마우스 오른쪽 버튼을 클릭하고 [복사]를 선택 grub 종료하면 quit를 입력한다.
-gedit 으로 열린 grub.conf 첫 부분에 "password --md5 <복사한 부분> 써 넣는다. 또 hiddenmenu는 삭제하거나 앞에 주석(#)을 붙이도록 한다.
3. 저장한 후에 시스템을 재부팅한다. 이제는 GRUB의 메뉴가 나타날 것이고 e 키를 눌리지 않을 것이다. GRUB를 편집 하려면 p 를 눌러서 정확한 비밀번호를 입력해야 한다. 더 이상 아무나 root 사용자의 비밀번호를 바꿀 수 없게 설정한 것이다.


모듈의 개념과 커널 컴파일의 필요성

커널의 가장 큰 역활은 "하드웨어"의 지원이라는 점을 상기하자. 초창기의 커널은 지원할 하드웨어가 그리 많지 않았으므로 커널에 하드웨어를 지원하는 코드를 모두 넣어 놓았다. 그런데 시간이 지날수록 지원해야 할 하드웨어가 많아지면서 커널에 넣어야 할 코드가 많아지자 커널이 점점 커지게 되었다. 커널이 커지면 컴퓨터의 자원을 많이 차지하여 결국은 운영체제가 무겁게 만드는 결과를 낳는다.

그런데 커널에 들어 있는 하드웨어를 제어하는 코드 중에서 어떤 부분은 항상 사용하는 것이 아니라 필요할 때만 가끔씩 사용되는 부분도 많이 생기게 되었다. 이렇게 자주 사용되지 않고 가끔 사용되는 코드는 커널에 넣기 보다는 별도로 보관해 두고, 필요할 때마다 호출하여 사용한다면 커널의 크기가 그렇게 크지 않아도 많은 하드웨어를 지원할 수 있지 않을까?

이렇듯 별도로 보관하였다가 필요할 때 마다 호출하여 사용되는 코드를 "모듈"이라도 부른다.

또 다른 사례로서 최근에 개발된 하드웨어를 장착했을 때를 생각해 보자. 기존의 커널은 지원하지 않지만 최신의 커널은 지원할 수도 있다 .이럴 때는 http://www.kernel.org에서 최신의 커널 소스를 다운로드해서 커널을 업그레이드할 필요가 있다

이 외에도 보안 문제로 인해서 커널을 업그레이드하는 경우가 있을 수 있다.

